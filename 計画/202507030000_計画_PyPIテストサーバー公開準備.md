# PyPIテストサーバー公開準備計画

## 概要
v0.2.0のsrc-checkをTestPyPIに公開し、正式なPyPIリリースに向けた最終準備を行う。

## 現状分析

### 完了済みタスク
- ✅ v0.2.0リリース準備（リリースノート、CHANGELOG更新）
- ✅ パッケージビルド（dist/配下に.whl、.tar.gz生成済み）
- ✅ バージョン統一（0.2.0）
- ✅ プロジェクトURL更新（pyproject.toml）

### 課題
- ⚠️ テストカバレッジが84%から61%に低下
  - CLI、Core、Formattersモジュールが0%カバレッジ
  - CLIテストがsubprocess経由のため計測されない
- 📝 プログレスレポートが実態と乖離（35%表示）

## 実施計画

### Phase 1: 品質改善（必須）
1. **テストカバレッジの回復**
   - [ ] CLIテストをimportベースに修正（subprocess → 直接import）
   - [ ] Formattersモジュールのテスト追加
   - [ ] Coreモジュールのテスト追加
   - [ ] 目標: 70%以上のカバレッジ回復

2. **ドキュメント最終確認**
   - [ ] README.mdの動作確認（インストール手順、使用例）
   - [ ] APIドキュメントの整合性確認

### Phase 2: TestPyPI公開準備
1. **パッケージ設定確認**
   - [ ] pyproject.tomlの最終確認
     - [ ] 依存関係の確認（tomlパッケージ追加要）
     - [ ] メタデータの確認
   - [ ] MANIFEST.inの確認（必要なファイルが含まれているか）

2. **TestPyPIアカウント準備**
   - [ ] TestPyPIアカウントの作成/確認
   - [ ] APIトークンの生成
   - [ ] .pypircファイルの設定

### Phase 3: TestPyPI公開
1. **アップロード**
   - [ ] twineインストール
   - [ ] TestPyPIへのアップロード
   ```bash
   python -m twine upload --repository testpypi dist/*
   ```

2. **動作確認**
   - [ ] 新規仮想環境作成
   - [ ] TestPyPIからインストール
   ```bash
   pip install -i https://test.pypi.org/simple/ src-check
   ```
   - [ ] 基本動作確認（src-check --help）
   - [ ] 実プロジェクトでの動作確認

### Phase 4: フィードバック対応
1. **問題点の修正**
   - [ ] インストール時の問題修正
   - [ ] 実行時エラーの修正
   - [ ] 依存関係の問題修正

2. **再ビルド・再公開**
   - [ ] 修正版のビルド
   - [ ] TestPyPIへの再アップロード

### Phase 5: 本番PyPI公開準備
1. **最終確認**
   - [ ] 全プラットフォームでの動作確認
   - [ ] Python 3.8-3.11での動作確認
   - [ ] ドキュメントの最終確認

2. **リリース準備**
   - [ ] GitHub Releasesページの準備
   - [ ] アナウンス文の準備

## タイムライン
- Phase 1: 1-2日（カバレッジ回復優先）
- Phase 2-3: 1日
- Phase 4: 1日
- Phase 5: 1日

合計: 4-5日

## 成功基準
1. TestPyPIからのインストールが正常に動作
2. src-checkコマンドが期待通りに実行される
3. テストカバレッジ70%以上
4. 3つ以上の環境での動作確認完了

## リスクと対策
1. **カバレッジ回復に時間がかかる**
   → 最低限70%を目標とし、残りはv0.3.0で対応
2. **依存関係の問題**
   → test-install/ディレクトリを活用して事前検証
3. **プラットフォーム固有の問題**
   → CI/CDでの自動テストを活用

## 次のアクション
1. CLIテストの修正から着手
2. TestPyPIアカウントの準備
3. カバレッジ70%達成後、即座にTestPyPI公開テスト