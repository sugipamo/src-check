# TestPyPI公開とテスト修正計画

## 📅 作成日
2025-07-03 00:43

## 🎯 目的
v0.2.0のTestPyPI公開とテスト失敗の解決を行い、正式リリースの準備を整える

## 📊 現在の状況
- パッケージビルド: ✅ 完了 (dist/配下に.whl, .tar.gz生成済み)
- テストカバレッジ: 82.9% (目標85%まであと2.1%)
- テスト結果: 144 passed, 35 failed, 3 errors
- ruffエラー: 21件 (テストファイルのみ)
- バージョン: v0.2.0で統一済み

## 🔧 優先タスク

### 1. TestPyPI公開 (最優先)
- [ ] TestPyPIアカウントの確認とAPIトークン設定
- [ ] twineを使用したTestPyPIへのアップロード
- [ ] TestPyPIからのインストールテスト
- [ ] 依存関係の解決確認
- [ ] CLIコマンドの動作確認

### 2. テスト失敗の修正 (高優先度)
- [ ] 35件の失敗テストの原因調査
  - [ ] フォーマッター関連のテスト失敗
  - [ ] KPI関連のテスト失敗
  - [ ] CLI関連のテスト失敗
- [ ] 3件のエラーの修正
- [ ] テスト修正後の再実行と確認

### 3. テストカバレッジ85%達成
- [ ] カバレッジレポートの分析
- [ ] 低カバレッジモジュールの特定
  - markdown.py (12%)
  - kpi_score.py (31%)
- [ ] 重要な未テスト部分のテスト追加
- [ ] カバレッジ85%達成の確認

### 4. コード品質改善
- [ ] ruffエラー21件の解決
  - I001: Import順序
  - F401: 未使用インポート
  - SIM117: 複数のwith文
- [ ] 型アノテーションの完全性確認
- [ ] ドキュメントの最終確認

## 📋 実行手順

### フェーズ1: TestPyPI公開 (30分)
1. TestPyPIアカウント準備
2. `twine check dist/*` で配布物の検証
3. `twine upload --repository testpypi dist/*`
4. `pip install -i https://test.pypi.org/simple/ src-check==0.2.0`
5. インストール後の動作確認

### フェーズ2: テスト修正 (2時間)
1. pytest実行で失敗テストの詳細確認
2. 失敗原因の分類と優先順位付け
3. 高優先度の失敗から順次修正
4. 修正後のテスト再実行

### フェーズ3: カバレッジ向上 (1時間)
1. coverage reportで低カバレッジ部分の特定
2. 重要な未テスト機能のテスト作成
3. テスト実行とカバレッジ確認

### フェーズ4: 最終確認 (30分)
1. 全テストの実行と合格確認
2. ruffエラーの解決
3. 最終的な品質チェック

## 🎯 成功基準
- [ ] TestPyPIへの公開成功
- [ ] TestPyPIからのインストール成功
- [ ] 全テスト合格 (0 failed, 0 errors)
- [ ] テストカバレッジ85%以上
- [ ] ruffエラー0件
- [ ] CLIコマンドの正常動作

## 📝 備考
- TestPyPI公開はユーザーのAPIトークンが必要
- テスト修正は品質向上の重要なステップ
- v0.2.0正式リリース前の最終段階