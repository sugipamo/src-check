# DeprecationChecker実装計画

## 概要
v0.2.0の最後のチェッカーとして、廃止予定機能の使用を検出する`DeprecationChecker`を実装します。

## 実装目標
- Python標準ライブラリの廃止予定機能検出
- サードパーティライブラリの廃止予定API検出
- 独自の`@deprecated`デコレータのサポート
- 廃止予定機能の代替案の提案

## 実装内容

### 1. DeprecationChecker クラスの実装
`src/src_check/rules/deprecation.py`に以下の機能を実装：

#### 検出パターン
1. **DEPR001**: Python標準ライブラリの廃止予定機能の使用
   - `imp`モジュール → `importlib`への移行推奨
   - `collections`の古いAPI → `collections.abc`への移行
   - `asyncio`の古いAPI使用

2. **DEPR002**: 廃止予定のデコレータ/関数の使用
   - `@deprecated`でマークされた関数の呼び出し
   - `warnings.warn(DeprecationWarning)`を含む関数の呼び出し

3. **DEPR003**: 古いPythonバージョンのみサポートする構文
   - Python 2スタイルのprint文
   - 古い文字列フォーマット（%演算子）の過度な使用

4. **DEPR004**: サードパーティライブラリの廃止予定API
   - pandas、numpy等の一般的なライブラリの廃止予定メソッド
   - バージョン情報に基づく検出

5. **DEPR005**: 型アノテーションの古い書き方
   - `typing.List` → `list`への移行（Python 3.9+）
   - `typing.Dict` → `dict`への移行

6. **DEPR006**: 非推奨のインポート方法
   - `from module import *`の使用
   - 循環インポートのリスクがある構造

### 2. テストケースの実装
`tests/unit/test_deprecation_checker.py`に以下のテストを実装：

- 各検出パターンの正常動作確認
- エッジケースのテスト
- 誤検知を防ぐテスト
- 代替案の提案が正しいことの確認

### 3. CLIへの統合
- `src/src_check/rules/__init__.py`への追加
- レジストリへの登録

## 実装手順

1. **基本構造の作成**（30分）
   - DeprecationCheckerクラスの基本実装
   - 基本的な検出ロジック

2. **検出パターンの実装**（60分）
   - 各DEPRコードの実装
   - AST解析ロジックの実装

3. **テストの実装**（45分）
   - ユニットテストの作成
   - カバレッジ85%以上を目指す

4. **統合とドキュメント**（30分）
   - CLIへの統合
   - ドキュメントの更新

## 成功基準

- [ ] 全95テスト + 新規テストが合格
- [ ] カバレッジ84%以上を維持
- [ ] mypyエラー0を維持
- [ ] 6種類以上の廃止予定パターンを検出
- [ ] 実用的な代替案の提案

## 予想される課題

1. **バージョン依存の検出**
   - Pythonバージョンによって廃止状況が異なる
   - 解決：sys.version_infoを使用した条件分岐

2. **サードパーティライブラリの検出**
   - ライブラリのバージョンによって異なる
   - 解決：一般的なパターンに絞って実装

3. **誤検知の防止**
   - 同名の異なるモジュール/関数
   - 解決：インポート文の解析を組み合わせる

## タイムライン

- 開始時刻: 2025-07-02 18:19
- 完了予定: 2025-07-02 21:00（約2時間40分）

## 次のステップ

DeprecationChecker実装完了後：
1. README.mdの更新（使用例の追加）
2. 各チェッカーの詳細ドキュメント作成
3. CI/CD統合ガイドの作成
4. v0.2.0のリリース準備