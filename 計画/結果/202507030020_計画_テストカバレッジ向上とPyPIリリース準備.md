# 計画: テストカバレッジ向上とPyPIリリース準備

## 概要
現在のプロジェクトはv0.2.0リリースの最終段階にあります。主要機能の実装は完了していますが、テストカバレッジの向上とPyPIへの公開準備が必要です。

## 現在の状況

### 完了項目
- ✅ 10種類のチェッカー実装完了
- ✅ CLI統合（src-check, src-check-kpi）
- ✅ パッケージビルド完了（dist/配下に.whlと.tar.gz生成）
- ✅ テストカバレッジ改善（61.41% → 73.98%）
- ✅ mypyエラー0達成

### 課題
- ⚠️ ruffエラー37件（主にテストファイル）
- ⚠️ テストカバレッジ73.98%（目標85%）
- ⚠️ src-check-kpiバージョン不整合（1.0.0 → 0.2.0）

## 優先タスク

### 1. 【最優先】PyPIテストサーバーへの公開（TestPyPI）
**理由**: v0.2.0リリースの最終段階として必須
**作業内容**:
1. TestPyPIアカウントの設定確認
2. `twine`を使用したアップロード
3. テスト環境でのインストール確認
4. 問題があれば修正

### 2. 【高優先】テストカバレッジ向上（73.98% → 85%）
**理由**: 品質保証の基準達成
**対象ファイル**（カバレッジが低い主要ファイル）:
- `formatters/markdown.py` (12%)
- `models/kpi_score.py` (31%)
- `cli/progress.py` (未測定の可能性)

**アプローチ**:
1. 各ファイルの未カバー部分を特定
2. ユニットテストの追加
3. エッジケースのテスト強化

### 3. 【中優先】ruffエラー37件の解決
**理由**: コード品質の向上
**主なエラータイプ**:
- I001: Import文の順序
- F401: 未使用のインポート
- SIM117: ネストしたwith文

**解決方法**:
1. テストファイルのインポート整理
2. 未使用インポートの削除
3. with文の統合

### 4. 【中優先】バージョン整合性の修正
**理由**: パッケージの一貫性確保
**作業内容**:
1. src-check-kpiのバージョンを0.2.0に統一
2. 関連ファイルの確認と修正

## 実行計画

### フェーズ1: PyPIテスト公開（1-2時間）
1. TestPyPIへのアップロード
2. 新規環境でのインストールテスト
3. 基本動作確認

### フェーズ2: 品質向上（2-3時間）
1. テストカバレッジの向上
   - markdown.pyのテスト追加
   - kpi_score.pyのテスト追加
2. ruffエラーの修正
   - テストファイルのクリーンアップ

### フェーズ3: 最終確認（1時間）
1. 全テストの実行
2. 各種メトリクスの確認
3. ドキュメントの最終チェック

## 成功基準
- [ ] TestPyPIへの公開成功
- [ ] テストカバレッジ85%以上
- [ ] ruffエラー0件
- [ ] 全テスト合格
- [ ] バージョン整合性確保

## リスクと対策
- **リスク**: TestPyPI公開時の予期しないエラー
  - **対策**: ローカルでの徹底的なテスト、段階的な公開

- **リスク**: テスト追加による既存機能への影響
  - **対策**: 小さな変更を段階的に実施、CI/CDでの確認

## 次のステップ
このタスク完了後:
1. PyPI正式公開
2. GitHub Releasesでのv0.2.0リリース
3. v0.3.0の開発開始（自動修正機能など）

---
作成日: 2025-07-03 00:20